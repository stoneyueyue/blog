# HTTP

## 万维网www

万维网www（World Wide Web）是一个资料空间。在这个空间中：一样有用的事物，称为一样”资源“；并且由一个全域”统一资源定位符“（URL）标识。这些资源通过超文本传输协议（HTTP）传送给使用者，后者通过点击链接来获取资源。

万维网的内核由三部分标准构成：

1. 统一资源定位符（URL）负责标识万维网上的各种文档，并使每个文档在整个万维网的范围内具有唯一的标识符URL。
2. 超文本传输协议（HTTP），它是一个应用层协议，使用TCP连接进行可靠传输，HTTP是万维网客户程序和服务器程序之间交互所必须严格遵守的协议。
3. 超文本标记语言（HTML）是一种文档结构别的标记语言，使用一些约定的标记对页面上的各种信息（包括文字、声音、图像和视频等）、格式进行描述。

## HTTP操作过程

1. 浏览器分析链接指向的URL
2. 浏览器向DNS请求解析域名对应的IP地址
3. 一名系统DNS解析出IP地址
4. 浏览器与服务器建立TCP链接
5. 浏览器发出HTTP请求：Get /xxx
6. 服务器通过HTTP响应把文件发送给浏览器
7. TCP链接释放（这里不是很准确）
8. 浏览器渲染页面

## HTTP协议的特点

HTTP协议是无状态的。

HTTP协议本身是无连接的，也就是说，虽然HTTP使用了TCP连接，但通信的双方在交换HTTP报文之前不需要建立HTTP连接。

HTTP既可以是非持久连接，也可以使用持久连接（HTTP/1.1 支持）

对与非持久连接，每一个网页元素对象（比如一个JPEG图，资源文件）的传输都需要单独建立一个TCP连接。

所谓持久连接就是万维网服务器在发送响应后仍然保持这条连接，使同一个客户和服务器可以继续在这条连接上传送后续的HTTP请求和响应报文。

持久连接又分为非流水线和流水线两种方式。对于非流水线方式，客户在收到前一个响应后才能发出下一个请求。HTTP/1.1 的默认模式是实用流水线的持久连接。这种情况下，客户每遇到一个对象引用就立即发出一个请求，所有请求和响应都是连续发送的。

## HTTP的报文结构

HTTP的请求报文和响应报文都是由三个部分组成：

1. 对报文进行描述的`起始行(start line)`
2. 包含属性的`首部（header）`块
3. 可选的、包含数据的`主体（body）`部分

```
GET /version.txt HTTP/1.1
Host: zoom.us

// 请求报文格式
<method> <request-URL> <version>
<headers>

<entity-body>

HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 237

// 响应报文格式
<version> <status> <reason-phrase>
<headers>

<entity-body>
```

请求报文格式和响应报文格式只有起始行有所不同。

- `方法（method）`：客户端希望服务器对资源执行的动作。
- `请求URL（request-URL）`：命名了所请求的资源。
- `版本（version）`：报文所使用的HTTP版本，其格式看起来是这样的`HTTP/<major>.<minor>`
- `状态码（status）`：这三位数描述了请求过程中所发生的情况。
- `原因短语（reason-phrase）`：数字状态码的可读版本。
- `首部（header）`：可以有零个或者多个首部，每个首部都包含一个名字，后面跟着一个冒号，然后是一个可选的空格，接着是一个值，最后是一个CRLF（空行）。首部是由一个CRLF结束的，表示了首部列表的结束和实体主体部分的开始。
- `实体主体部分（entity-body）`：包含一个由任意数据组成的数据块。并不是所有报文都包含实体主体部分。

## HTTP方法

- `GET`: 从服务器获取一份文档
- `HEAD`: 只从服务器获取文档的首部
- `POST`: 向服务器发送需要处理的数据
- `PUT`: 将请求主体部分存储在服务器上
- `TRACE`: 对可能经过代理服务器传送到服务器上去的报文进行追踪
- `OPTIONS`: 决定可以在服务器上执行哪些方法
- `DELETE`: 从服务器上删除一份文档
