<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>计算机网络</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b6bfb1ac.css" as="style"><link rel="preload" href="/blog/assets/js/app.b810b8e6.js" as="script"><link rel="preload" href="/blog/assets/js/2.d4e17b65.js" as="script"><link rel="preload" href="/blog/assets/js/6.5fa9a413.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.65e3c5a8.js"><link rel="prefetch" href="/blog/assets/js/11.548f3fec.js"><link rel="prefetch" href="/blog/assets/js/12.4fa9afea.js"><link rel="prefetch" href="/blog/assets/js/13.d6e70314.js"><link rel="prefetch" href="/blog/assets/js/14.ba3eab0c.js"><link rel="prefetch" href="/blog/assets/js/15.5a956ea1.js"><link rel="prefetch" href="/blog/assets/js/3.5c6abdc9.js"><link rel="prefetch" href="/blog/assets/js/4.5a22df0b.js"><link rel="prefetch" href="/blog/assets/js/5.35f321f1.js"><link rel="prefetch" href="/blog/assets/js/7.c23ce467.js"><link rel="prefetch" href="/blog/assets/js/8.eed45d92.js"><link rel="prefetch" href="/blog/assets/js/9.b7c8d839.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b6bfb1ac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>编程基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/basic/network.html" aria-current="page" class="active sidebar-link">计算机网络</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/basic/network.html#分类" class="sidebar-link">分类</a></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#性能指标" class="sidebar-link">性能指标</a></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#计算机网络分层" class="sidebar-link">计算机网络分层</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/basic/network.html#为什么要做分层" class="sidebar-link">为什么要做分层？</a></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#网络分层的基本原则" class="sidebar-link">网络分层的基本原则</a></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#iso-osi参考模型" class="sidebar-link">ISO/OSI参考模型</a></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#tcp-ip模型" class="sidebar-link">TCP/IP模型</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#物理层" class="sidebar-link">物理层</a></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#数据链路层" class="sidebar-link">数据链路层</a></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#网络层" class="sidebar-link">网络层</a></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#传输层" class="sidebar-link">传输层</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/basic/network.html#ip协议" class="sidebar-link">IP协议</a></li><li class="sidebar-sub-header"><a href="/blog/basic/network.html#tcp协议" class="sidebar-link">TCP协议</a></li></ul></li></ul></li><li><a href="/blog/basic/web-socket.html" class="sidebar-link">Web Socket</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/html/html-semantic.html" class="sidebar-link">HTML 语义化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript标准内置对象</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/JavaScript标准内置对象/Function.html" class="sidebar-link">Function</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Web API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/web-api/event.html" class="sidebar-link">Event</a></li><li><a href="/blog/web-api/event-target.html" class="sidebar-link">EventTarget</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Compile &amp; Build</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/compile-build/arrow-function.html" class="sidebar-link">箭头函数</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="计算机网络"><a href="#计算机网络" class="header-anchor">#</a> 计算机网络</h1> <p><code>计算机网络</code>是一个将分散的、具有独立功能的计算机系统，通过通信设备与线路连接起来，由功能完善的软件实现资源共享和信息传递的系统。</p> <p>计算机网络的主要五大功能：</p> <ol><li>数据通信</li> <li>资源共享</li> <li>分布式处理</li> <li>提高可靠性</li> <li>负载均衡</li></ol> <h2 id="分类"><a href="#分类" class="header-anchor">#</a> 分类</h2> <p>计算机网络按照分布范围分类，分成：</p> <ol><li>广域网（WAN）</li> <li>城域网（MAN）</li> <li>局域网（LAN）</li> <li>个人局域网（PAN）</li></ol> <ul><li>VPN（Virtual Private Network）在公用网络上建立专用网络，进行加密通讯。在企业网络中有广泛应用。</li></ul> <h2 id="性能指标"><a href="#性能指标" class="header-anchor">#</a> 性能指标</h2> <ol><li><code>带宽（Bandwidth）</code>表示网络的通信线路所能传送数据的能力，单位是：“比特每秒”（b/s）</li> <li><code>延时（Delay）</code>是指数据从网络的一段传送到晾一段所需要的总时间，由四个部分组成：发送延时、传播延时、处理延时和排队延时。</li> <li><code>时延带宽积</code>若发送端连续发送数据，在发送的第一个比特即将到达终点时，表示发送端已经发出的比特数。即，时延带宽积 = 传播时延 x 信道带宽</li> <li><code>往返时延（Round-Trip Time, RTT）</code>表示从发送端发送数据开始，到发送端收到来自接收端的确认，总共经历的时延。在互联网中，往返时延还包包括各中间节点的处理时延、排队时延以及传发数据时的发送时延。</li> <li><code>吞吐量（Throughput）</code>表示在单位时间内通过某个网络（或信道、接口）的数据量。吞吐量受网络带宽和网络的额定速率的限制。</li> <li><code>速率（Speed）</code>网络中的速率是指链接在计算机网络上的主机在数字信道上传送数据的速率，也称为数据率或者比特率，单位是b/s。当数据率较高时，就可以用Kb/s、Mb/s或Gb/s。在计算机网络中，通常吧最高数据率称为带宽。</li></ol> <h2 id="计算机网络分层"><a href="#计算机网络分层" class="header-anchor">#</a> 计算机网络分层</h2> <h3 id="为什么要做分层"><a href="#为什么要做分层" class="header-anchor">#</a> 为什么要做分层？</h3> <p>两个系统中实体间的通信是一个很复杂的过程，为了降低协议设计和调试过程的复杂性，也为了方便于对网络进行研究、实现和维护，促进标准化工作，通常对计算机网络的体系结构以分层的方式进行建模。</p> <h3 id="网络分层的基本原则"><a href="#网络分层的基本原则" class="header-anchor">#</a> 网络分层的基本原则</h3> <ol><li>每一层都实现一种相对独立的功能，能大大降低系统的复杂度</li> <li>各层之间界面自然清晰，易于理解，相互交流尽可能少。</li> <li>各层功能的精确定义独立于具体的实现方法，可以采用最佳的技术来实现。</li> <li>保持下层对上层的独立性，上层单向使用下层提供的服务。</li> <li>整个分层结构应能促进标准化工作。</li></ol> <p>在计算机网络体系结构的各个层次中，每一个报文都分为两个部分，一个是数据部分，也就是SDU，另外一部分是控制信息部分，也就是PCI，他们共同组成PDU。</p> <ul><li><code>服务数据单元（SDU）</code>为完成用户所要求的的功能而应传送的数据。第n层的服务数据单元记为n-SDU。</li> <li><code>协议控制单元（PCI）</code>控制协议操作的信息。第n层的协议控制单元记为n-PCI。</li> <li><code>协议数据单元（PDU）</code>对等层次之间传送的数据单位称为该层的PDU。第n层的协议数据单元称为n-PDU。</li></ul> <p>在实际的网络中，每层的协议数据单元都有一个通俗的名称，如物理层的PDU叫比特，链路层的PDU叫帧，网络层的PDU叫分组，传输层的PDU叫报文。</p> <p>在各层间传输数据时，把从第n+1层收到的PUD作为第n层的SDU，加上第n层的PCI，就变成了了第n层的PUD，交给第n-1层后作为SDU发送，接收方接收时做相反的处理。</p> <h3 id="iso-osi参考模型"><a href="#iso-osi参考模型" class="header-anchor">#</a> ISO/OSI参考模型</h3> <ol><li>应用层</li> <li>表示层</li> <li>会话层</li> <li>传输层</li> <li>网络层</li> <li>数据链路层</li> <li>物理层</li></ol> <h3 id="tcp-ip模型"><a href="#tcp-ip模型" class="header-anchor">#</a> TCP/IP模型</h3> <ol><li>应用层（用户-用户）
<ul><li>HTTP</li> <li>SMTP</li> <li>DNS</li> <li>RTP</li></ul></li> <li>传输层（应用-应用）
<ul><li>TCP</li> <li>UDP</li></ul></li> <li>网际层（主机-主机）
<ul><li>IP</li></ul></li> <li>网络接口层</li></ol> <h2 id="物理层"><a href="#物理层" class="header-anchor">#</a> 物理层</h2> <h2 id="数据链路层"><a href="#数据链路层" class="header-anchor">#</a> 数据链路层</h2> <h2 id="网络层"><a href="#网络层" class="header-anchor">#</a> 网络层</h2> <h2 id="传输层"><a href="#传输层" class="header-anchor">#</a> 传输层</h2> <h3 id="ip协议"><a href="#ip协议" class="header-anchor">#</a> IP协议</h3> <h4 id="ipv4分组"><a href="#ipv4分组" class="header-anchor">#</a> IPv4分组</h4> <p>IPv4，即现在普遍使用的IP协议（版本为4）。IP协议定义数据传送的基本单元——IP分组及其确切的数据格式。</p> <h5 id="ipv4分组的格式"><a href="#ipv4分组的格式" class="header-anchor">#</a> IPv4分组的格式</h5> <p>一个IP分组由首部和数据两部分构成。首部的前一部分是固定长度的，共20字节。是所有IP分组必须具有的。在首部固定部分的后面是一些可选字段，其长度是可变的，用来提供错误检测和安全等机制。</p> <h5 id="ip数据报分片"><a href="#ip数据报分片" class="header-anchor">#</a> IP数据报分片</h5> <p>一个链路层数据报能承载的最大数据量称为最大传送单元（MTU）。因为IP数据报被封装在链路层数据报中，故链路层的MTU严格地限制着IP数据报的长度，而且在IP数据报的源与目的地路径上的各段链路可能使用不同的链路层协议，有不同的MTU。例如以太网的MTU为1500字节，而许多广域网的MTU不超过576字节。当IP数据报的总长度大于链路MTU时，就需要将IP数据报中的数据分装在两个或更多个较小的IP数据报中，这些小的数据报叫做片。</p> <p>当一个路由器需要将一个数据报分片时，形成的每个数据报（即片）都具有原始数据报的<code>标识号</code>。</p> <p>片在目的地的网络层被重新组装。目的主机使用IP首部中的标识、标志和偏移字段来完成对片的组装。</p> <h4 id="ipv4地址与nat"><a href="#ipv4地址与nat" class="header-anchor">#</a> IPv4地址与NAT</h4> <h3 id="tcp协议"><a href="#tcp协议" class="header-anchor">#</a> TCP协议</h3> <h4 id="tcp协议的特点"><a href="#tcp协议的特点" class="header-anchor">#</a> TCP协议的特点</h4> <p>TCP是在不可靠的IP层之上实现的可靠的数据传输协议，他主要解决传输的可靠、有序、无丢失和不重复的问题。</p> <ol><li>TCP是面向连接的传输层协议。</li> <li>每一条TCP连接只能有两个端点，每一条TCP连接只能是点对点的链接。</li> <li>TCP提供可靠的交付服务，保证传送的数据无差错、不丢失、不重复且有序。</li> <li>TCP提供全双工通信，TCP允许通信双方的应用进程在任何时候都能发送数据，为此TCP连接的两端都舍友发送缓存和接收缓存，用来临时存放双向通信的数据。
<ul><li>发送缓存用来暂时存放以下数据：
<ol><li>发送应用程序传送给发送方TCP准备发送的数据</li> <li>TCP已经发送出但尚未收到确认的数据</li></ol></li> <li>接收缓存用来暂时存放以下数据：
<ol><li>按序到达的但尚未被接收应用程序读取的数据</li> <li>不按序到达的数据</li></ol></li></ul></li></ol> <h4 id="tcp报文段"><a href="#tcp报文段" class="header-anchor">#</a> TCP报文段</h4> <p>TCP传送的数据单元称为报文段。一个TCP报文段分为TCP首部和TCP数据两部分，整个TCP段作为IP数据报的数据部分封装在IP数据报中。</p> <p>TCP报文段既可以用来运载数据，也可以用来建立连接、释放连接和应答。</p> <h4 id="tcp连接管理"><a href="#tcp连接管理" class="header-anchor">#</a> TCP连接管理</h4> <p>TCP是面向链接的协议。因此每一个TCP连接都有三个阶段：连接建立、数据传送和连接释放。TCP连接的管理就是使运输连接的建立和释放都能正常运行。</p> <p>TCP把连接作为最基本的抽象，每一条TCP连接都有两个端点，TCP连接的端点不是主机，不是主机的IP地址，不是应用进程，也不是传输层的协议端口。TCP连接的端口叫做套接字（scoket）或插口。端口拼接到IP地址即构成了套接字。</p> <p>TCP连接的建立采用客户端/服务器的方式。主动发起连接建立的应用进程叫做客户机（Client），而被动等待连接建立的应用进程叫做服务器（Server）。</p> <h5 id="tcp连接的建立"><a href="#tcp连接的建立" class="header-anchor">#</a> TCP连接的建立</h5> <p>三次握手</p> <p><img src="/blog/assets/img/tcp_seup.28a8c3d6.png" alt="image"></p> <p><code>第一步</code>：客户机的TCP首先向服务器的TCP发送一个连接请求的报文段。这个特殊的报文段中不含应用层数据。起首部中的SYN标志位被置为1。另外，客户机会随机选择一个起始序号seq=x（连接请求报文不携带数据，但要消耗掉一个序号）。</p> <p><code>第二步</code>：服务器的TCP收到连接请求报文段后，如同意建立连接，就想客户机发回确认，并<code>为该TCP连接分配TCP缓存和变量</code>。在确认报文段中，SYN和ACK位都被置为1，确认号字段ack的值为x+1，并且服务器随机产生起始序号seq=y（确认报文不携带数据，但也要消耗掉一个序号）。确认报文同样不包含应用层数据。</p> <p><code>第三步</code>：当客户机收到确认报文后，还要向服务器给出确认，并且也要给该连接分配缓存和变量。这个报文的ACK字段被置为1，需要字段变为x+1，确认号字段为ack=y+1。该报文可以携带数据，如不携带数据则不消耗序号。</p> <p>在成功进行了以上三步以后，TCP连接就建立了，接下来就可以传送应用层数据了。</p> <p>注意，服务端的资源是在完成第二次握手的时候分配的，客户端的资源是在完成第三次握手的时候分配的。这就使得服务器易于收到SYN洪泛攻击。</p> <h5 id="tcp连接的释放"><a href="#tcp连接的释放" class="header-anchor">#</a> TCP连接的释放</h5> <p>参与TCP连接的两个进程中的任何一个都能终止该连接。TCP的释放过程可以称为“四次挥手”</p> <p><img src="/blog/assets/img/tcp_close.1565edd5.png" alt="image"></p> <p><code>第一步</code>：客户端打算关闭连接，就向其TCP发送一个连接释放的报文段，并停止再发送数据，主动关闭TCP连接，该报文的FIN字段被置为1，seq=u(它等于前面已传送过最后一个字节的序号加1，FIN报文段即使不携带数据，也要消耗掉一个序号)。
TCP是全双工的，即可以想象成是一条TCP上有两条数据通路。当发送FIN报文时，发送FIN的一段就不能再发送数据，也就是关闭了其中一条数据通路，但对方还可以发送数据。</p> <p><code>第二步</code>：服务器接收到连接释放报文后即发出确认，确认号是ack=u+1，而这个报文段自己的序号是v，它等于前面已传送过最后一个字节的序号加1。此时客户端收到服务器的这个方向的链接就释放了，TCP连接出于<code>半关闭状态</code>。单服务器若发送数据，客户机仍要接收，即从服务器到客户机这个方向的连接并未关闭。</p> <p><code>第三步</code>：若服务器已经没有要向客户机发送的数据，就通知TCP释放连接，此时其发出FIN=1的连接释放报文段。</p> <p><code>第四步</code>：客户机收到连接释放报文段后，必须发出确认。在确认报文段中，ACK字段被设置为1，确认号ack=w+1，序号seq=u+1，此时TCP连接还没有释放掉，必须经过时间等待计时器设置的时间2MSL后，客户机才进入到连接关闭状态。</p> <h4 id="tcp可靠传输"><a href="#tcp可靠传输" class="header-anchor">#</a> TCP可靠传输</h4> <ul><li>校验</li> <li>序号</li> <li>确认</li> <li>重传</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/basic/web-socket.html">
        Web Socket
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.b810b8e6.js" defer></script><script src="/blog/assets/js/2.d4e17b65.js" defer></script><script src="/blog/assets/js/6.5fa9a413.js" defer></script>
  </body>
</html>
